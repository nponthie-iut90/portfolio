import{N as n}from"./NavBar-RpPqGWj2.js";import{_ as a,d as u,w as o,r,o as c,a as p,b as e,e as d}from"./index-kCQl9cRz.js";const i="/portfolio/images/script.png",m={name:"Project1",components:{NavBar:n}};function f(g,l,b,h,v,S){const t=r("NavBar"),s=r("v-container");return c(),u(s,{style:{width:"1000px","padding-bottom":"500px"}},{default:o(()=>[p(t),l[0]||(l[0]=e("br",null,null,-1)),l[1]||(l[1]=e("br",null,null,-1)),l[2]||(l[2]=e("br",null,null,-1)),l[3]||(l[3]=e("div",{style:{"text-align":"center"}},[e("h1",{style:{"font-weight":"bold"}},"Création d'un script de formatage"),e("img",{src:i,alt:"image",style:{height:"300px"}}),e("p",{style:{"font-weight":"bold"}}," Création d'un script pour formater et copier des fichiers sur une clé usb "),e("br")],-1)),l[4]||(l[4]=e("div",{style:{},class:"content-container"},[e("h1",null,"Création d'un Script PowerShell pour la Préparation de Clés USB"),e("h2",null,"1. L’origine de la création du script"),e("p",null," Un client avait besoin de distribuer un grand nombre de clés USB avec des fichiers ne devant pas pouvoir être supprimés. Il y avait une cinquantaine de clés USB à préparer. Il y a plusieurs étapes à réaliser pour chaque clé USB : "),e("ul",null,[e("li",null," Formater la clé au format NTFS (pour pouvoir appliquer des droits de lecture/écriture) "),e("li",null,"Copier les fichiers sur la clé USB"),e("li",null,"Modifier les droits de lecture/écriture de la clé USB et des fichiers")]),e("br"),e("p",null," Ces étapes sont très répétitives et il est facile de faire une erreur/un oubli ; de plus, toutes ces étapes prennent beaucoup de temps. C’est pourquoi j’ai décidé de créer un script pouvant réaliser toutes ces étapes en un seul clic. "),e("br"),e("h2",null,"2. Le développement du script"),e("h3",null,"2.1 Les contraintes"),e("p",null," Pour garantir que le script puisse s'exécuter sur n'importe quel PC Windows, j'ai opté pour l'utilisation de PowerShell car il est disponible sur tous les PC Windows, il permet d’utiliser les outils systèmes pour pouvoir formater les clés USB, et de créer des interfaces graphiques légères. Bien que je ne connaisse pas très bien PowerShell, il est facile de trouver beaucoup d’exemples en ligne. Toutes ces raisons m’ont donc conduit à choisir PowerShell. "),e("br"),e("h3",null,"2.2 Le principe du script"),e("p",null," Le script demande d’abord l’utilisation des droits administrateurs (nécessaire pour le formatage). L’interface graphique demande alors 5 paramètres : "),e("div",{class:"list-container"},[e("ul",null,[e("li",null,"La clé USB à formater (obligatoire)"),e("li",null,"Le dossier contenant les fichiers à copier sur la clé USB (obligatoire)"),e("li",null,"Les droits à appliquer : lecture seule/lecture et écriture"),e("li",null,"Le nom à donner à la clé USB (facultatif)"),e("li",null,"Le chemin vers l’icône à donner à la clé USB (facultatif)")]),e("figure",null,[e("img",{src:i,alt:"image",style:{height:"300px","margin-right":"350px"}}),e("figcaption",null," figure1: interface graphique du script avec les différents paramètres à renseigner ")])]),e("br"),e("p",null," Il n’y a pas de difficultés particulières à la création de cette interface, la seule difficulté a été de trouver une combinaison de commandes capables de proposer uniquement les clés USB, d’afficher leurs noms et leurs lettres de lecteur. "),e("br"),e("p",null," Une fois le bouton « Démarrer le formatage et la copie » enclenché, le script effectue les étapes suivantes : "),e("ol",null,[e("li",null,"Formatage de la clé USB au format NTFS à l’aide de « Disk Part », composant système"),e("li",null,"Copie des fichiers sur la clé USB"),e("li",null,[d(" Si un nom et/ou une icône a été spécifié : "),e("ol",{type:"a"},[e("li",null," On crée un fichier « autorun.inf » en y indiquant le nom et/ou l’icône à utiliser "),e("li",null,"On copie l’icône sur la clé USB s’il y en a un"),e("li",null,"On donne à ces deux fichiers l’attribut « caché »")])]),e("li",null,"On applique les droits sur la clé et les fichiers"),e("li",null,"La clé USB est prête")]),e("br"),e("h1",null,"2. Conclusion"),e("p",null," La création de ce script m’a pris l’équivalent d’une journée de travail, mais il fera gagner un temps précieux dans le futur. Le développement de ce script a été très intéressant pour moi, car il a permis de mêler plusieurs choses ensemble comme l’utilisation d’outils systèmes comme Disk Part et la gestion des droits. Cela m’a permis d’apprendre que je peux créer un script avec une interface graphique relativement rapidement pour répondre à un problème qui aurait pris des heures à réaliser manuellement. ")],-1))]),_:1,__:[0,1,2,3,4]})}const U=a(m,[["render",f],["__scopeId","data-v-d82279c0"]]);export{U as default};
